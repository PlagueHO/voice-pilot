# Threat Model Review Procedure

## Purpose

Establish a repeatable, auditable process for fulfilling the review cadence mandated by `sp-056-spec-architecture-security-threat-model.md` before every release and on the scheduled weekly automation check.

## Inputs

- `spec/threat-register.json`
- `spec/threat-register-report.json` (generated by `npm run validate:threats`)
- Latest CI results for `npm run validate:threats` and `npm run quality:gate`

## Pre-Review Checklist

1. Run `npm install` to ensure dependencies (notably `ajv` and `ajv-formats`) are present.
2. Execute `npm run validate:threats` and confirm success output.
3. Inspect `spec/threat-register-report.json` for `openHighRisk` entries.
4. Verify new threats or mitigations reference relevant specification controls (SP-003, SP-004, SP-005, SP-006, SP-027, SP-050).
5. Collect evidence of passing regression tests referenced in mitigation `verification` fields.

## Review Steps

1. **Schema & Domain Validation**
   - Confirm validator succeeded without errors.
   - Ensure DREAD â‰¥ 60 threats are `Mitigated` with residual risk below High.
2. **Mitigation Coverage**
   - Verify each allowed specification has at least one mapping in `mitigationCoverage`.
   - Cross-check new mitigations include executable verification hooks (`test:` or `audit:`).
3. **Residual Risk Assessment**
   - For each entry in `report.openHighRisk`, determine remediation owner and ETA.
   - Escalate blocking risks to release manager if status remains `Open`.
4. **Artifact Updates**
   - Update the `lastUpdated` field in `spec/threat-register.json`.
   - Record decisions, deferrals, and follow-up actions in Git history (commit notes or issues).
5. **Approval**
   - Security Champion signs off via pull request review or issue comment referencing the report snapshot.

## Automation Hooks

- `scripts/validate-threat-register.mjs` enforces schema checks and produces the report.
- `.github/workflows/threat-model-review.yml` runs weekly and opens an issue if any high-risk threats remain unmitigated.

## Exit Criteria

- No `openHighRisk` entries remain unless formally accepted and tagged `status: Accepted` with executive approval.
- Threat register version incremented if new threats are added or mitigations materially change.
- Review notes captured in repository (issue, PR, or `docs/process/threat-model-review.md` changelog).
